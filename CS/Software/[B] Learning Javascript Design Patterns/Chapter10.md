# Chapter10. 모듈형 자바스크립트 디자인 패턴

AMD, CJS, UMD

## CJS(Common JS)

브라우저에서만 사용되던 자바스크립트를 서버 사이드단에서도 범용적으로 사용될 수 있도록 모듈 시스템을 제작하자!

- 모듈을 동기적으로 호출하는 방식
- `module.exports` 와 `require()`
- 비동기 방식보다 느리고, 트리 쉐이킹 어려움, 순환 참조 취약
- Node.js가 CJS를 표준으로 채택 후 구현 → 현재는 ESM도 안정적으로 지원
- 인기 많아진 CJS 방식을 브라우저단에서도 사용해보려는 도구가 **Browserify**

### AMD(Asynchronous Module Definition)

비동기적으로 모듈을 실행하자!

- 비동기 상황에서 모듈 어떻게 할지 CJS와 논의하다가 합의점 못찾고 나온 그룹
- 브라우저, 서버 사이드 모두 호환되는 방식
- 이를 구현한 대표적인 모듈 로더 라이브러리가 **RequireJS**

## UMD(Universal Module Definition)

CJS와 AMD 방식을 모두 호환해볼게!

## ESM(ES6 Module)

ES6에서 자바스크립트 표준 모듈 시스템 명세가 등장!

- 동기/비동기 로드 모두 지원
- 간단한 문법 → `import` 와 `export`
- 실제 객체/함수를 바인딩하기 때문에 순환 참조 관리도 편리, 정적 분석 가능, 트리 쉐이킹 가능!
- 그러나 최신 문법인지라 구형 브라우저에서는 동작 안해. 모든 환경에서 모듈 시스템을 사용하기 위한 모듈 로더 SystemJS 까지 등장

## Transfiler

: 최신 문법과 함께 자바스크립트를 작성하면 이를 한번에 컴파일해서 구형 브라우저에서도 동작하는 자바스크립트로 변환해주는 도구 등장

- 대표적인 도구가 **Babel** → 호환성 해결
- CoffeScript, **Typescript** 같은 슈퍼셋 언어까지 등장

### Task Runner

: 린트, 번들링, 빌드, 최적화, 테스트 등 프로덕트 개발 과정에서 필요한 일련의 과정들을 자동화하는 도구

- 대표적인 도구가 **Grunt, Gulp**
- 현재는 번들러 자체에서도 각종 플러그인을 제공하고 있기 때문에 별도의 테스크 러너를 잘 사용하지 않음

### Bundler

: 자바스크립트 모듈을 브라우저에서 실행할 수 있는 단일 파일로 번들링하는 데 사용되는 도구

- 모듈 로더들은 런타임에 모듈을 가져오는데 초점 두었다면, 번들러는 빌드 시 모듈을 묶어서 단일 번들 파일로 만들기 때문에 런타임에서 모듈을 추가로 불러올 필요가 없음
- 모든 브라우저에서 모듈 시스템 호환될 수 있도록 하고, 코드 종속성 관계나 순서 관리하고, 다른 에셋 로드하고, 트리 쉐이킹 기능까지 등등
- 대표적 번들러
  - Webpack → 높은 안정성. 뛰어난 개발 서버 기능(HMR), 복잡한 설정, ES6 모듈 형태로 빌드 결과물을 출력할 수 없다?
  - Rollup → 웹팩과 유사하지만 ES6 형식으로 결과물 출력 가능. 강한 코드 스플리팅
  - Parcel → Zero config. ESM/CJS 모두 트리 쉐이킹 지원.
  - ESBuild